Tables and Columns Used
PV_MBR_NRT_SUMMARY_TV

START_TV_DTM

PV_FISCAL_DAY_TO_YEAR

WORKDAY_IN_FISCAL_WEEK_NUM

WORKDAY_IN_FISCAL_WTD_COUNT

CALENDAR_DATE

PV_MBR_NRT_SUMMARY (aliased as s)

LVL

L0_SALES_TERRITORY_DESCR

L1_SALES_TERRITORY_DESCR

L2_SALES_TERRITORY_DESCR

L3_SALES_TERRITORY_DESCR

L4_SALES_TERRITORY_DESCR

L5_SALES_TERRITORY_DESCR

L6_SALES_TERRITORY_DESCR

ACTUAL_TO_AMT

ORACLE_ACTUAL_AMT

POS_AMT

DSV_POS_AMT

EIS_CM_AMT

XAAS_BKGS_AMT

CURR_DAY_ACTUAL_AMT

CURR_DAY_ACTUAL_WTD_AMT

FISCAL_YEAR_WEEK_NUM_INT

CEC_ID

PV_MBR_PROCESS_DATE (aliased as p)

FISCAL_YEAR_WEEK_NUM_INT

PV_MBR_NXT_GEN_FCST_DETAIL (aliased as f)

LVL

L0_SALES_TERRITORY_DESCR

L1_SALES_TERRITORY_DESCR

L2_SALES_TERRITORY_DESCR

L3_SALES_TERRITORY_DESCR

L4_SALES_TERRITORY_DESCR

L5_SALES_TERRITORY_DESCR

L6_SALES_TERRITORY_DESCR

WEEK_FCST_AMT

FISCAL_YEAR_WEEK_NUM_INT

BK_FORECAST_CATEGORY_NAME

FORECAST_TYPE_CD

CEC_ID

What the Query Does (English Description)
Identify the Current Fiscal Week

Finds the latest data‐load timestamp from the summary‐TV table.

Uses that date to look up how many workdays are in the current fiscal week (total_days) and how many have elapsed so far (day_in_num).

Aggregate “Actuals” (Bookings) for the User

Pulls all booking metrics (actuals to date, Oracle actuals, POS, DSV, EIS adjustments, XAAS, and daily actuals) for CEC ID = ' schuri ' in the current week.

Rolls the sales hierarchy up into two columns:

std_parent: the territory at the user’s highest level

std: the territory at the user’s own level

Sums each metric over that week.

Aggregate “Forecast” for the Same User and Week

Pulls the NXT-GEN “Product NXT” forecast for CEC ID = ' schuri ' in the same week.

Rolls the hierarchy into the same std_parent/​std columns.

Sums the weekly forecast amount.

Combine Actuals and Forecast

Performs a FULL OUTER JOIN on (std_parent, std), so you see every territory that has actuals, forecast, or both.

Uses COALESCE to display whichever hierarchy value exists.

Places all actuals metrics alongside the forecast.

Compute Progress Metrics

current_week_percent: percentage of the forecast that’s been achieved so far.

current_week_to_go: how much of the forecast remains for the week.

Result Ordering

Finally, it orders the output by std_parent then std, giving you a clear, hierarchical view of actuals vs. forecast and pacing across your sales territory structure.
